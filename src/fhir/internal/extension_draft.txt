  considering sticking all extensions same big array
  use fake url _family _text _use_ etc
  ^would not work so well for lists though

  use extension <- primitive_extension("family", extension)
  use extension <- primitive_extension("text", extension)
  use extension <- primitive_extension("use_", extension)


    // get extensions from primitive fields and add them to main extensions list
    // feels like there should be a better way or better thing to do instead
      pub fn primitive_extension(
        field_name: String,
        existing_extension: List(Extension),
        cb: fn(List(Extension)) -> decode.Decoder(a),
      ) -> decode.Decoder(a) {
        let field_ext_name = \"_\" <> field_name
        decode.then(
          decode.map(
            decode.optionally_at(
              [field_ext_name, \"extension\"],
              [],
              decode.list(extension_decoder()),
            ),
            fn(field_ext) {
              case field_ext {
                [] -> existing_extension
                new_field_ext -> [
                  Extension(
                    id: None,
                    url: field_ext_name,
                    ext: ExtComplex(new_field_ext),
                  ),
                  ..existing_extension
                ]
              }
            },
          ),
          cb,
        )
      }

tbh this is terrible idea should do _family or in some kind of fhirstring primitive


unrelated (could copy params but type constructor doesnt work):
fn gen_copy_searchparams_from_sansio(first_entry: Entry) {
  let search_type =
    list.map(first_entry.resource.rest, fn(rest) {
      list.map(rest.resource, fn(res) {
        let name_capital = string.capitalise(res.type_)
        "pub type Sp"
        <> name_capital
        <> " = FHIRVERSION_sansio."
        <> "Sp"
        <> name_capital
        <> "\n"
      })
      |> string.concat
    })
    |> string.concat
  let search_type_new =
    list.map(first_entry.resource.rest, fn(rest) {
      list.map(rest.resource, fn(res) {
        let name_lower = string.lowercase(res.type_)
        "pub fn sp_"
        <> name_lower
        <> "_new(){FHIRVERSION_sansio.sp_"
        <> name_lower
        <> "_new()}\n"
      })
      |> string.concat
    })
    |> string.concat
  search_type <> search_type_new
}
